
<% if signed_in? %>
    <SCRIPT type="text/javascript">
        <!--
        var curMenu = null, zTree_Menu = null;
        function leftMeunsOnClick(event, treeId, treeNode) {
            if (treeNode.uri!=''){
                $.ajax({
//                    url:treeNode.uri+'?hos_id='+treeNode.hospital_id+'&dep_id='+treeNode.department_id+'&menu_id='+treeNode.id,
                    url:treeNode.uri,
                    type:'get',
                    beforeSend:function(response){
                             $("#rightContent").html('<div style="text-align:center;width:100px;height:100px;border:1px solid #dcdcdc;position:absolute;left:50%;margin-top:150px;background:#d9edf0;line-height:100px;font-weight:bold;">loading...</div>')
                    },
                    success:function (response,data){
                        $('#rightContent').html(response)
                    },
                    error:function(response){
                        $('#rightContent').html('response')
                    }
                })
            }

        };
        var setting = {
            view: {
                showLine: true,
                showIcon: false,
                selectedMulti: false,
                dblClickExpand: false


            },
            data: {
                simpleData: {
                    enable: true
                }
            },
            callback: {
                onClick: leftMeunsOnClick,
                beforeClick: this.beforeClick
            }

        };
        function beforeClick(treeId, node) {
            if (node.isParent) {
                if (node.level === 0) {
                    var pNode = curMenu;
                    while (pNode && pNode.level !==0) {
                        pNode = pNode.getParentNode();
                    }
                    if (pNode !== node) {
                        var a = $("#" + pNode.tId + "_a");
                        a.removeClass("cur");
                        zTree_Menu.expandNode(pNode, false);
                    }
                    a = $("#" + node.tId + "_a");
                    a.addClass("cur");

                    var isOpen = false;
                    for (var i=0,l=node.children.length; i<l; i++) {
                        if(node.children[i].open) {
                            isOpen = true;
                            break;
                        }
                    }
                    if (isOpen) {
                        zTree_Menu.expandNode(node, true);
                        curMenu = node;
                    } else {
                        zTree_Menu.expandNode(node.children[0].isParent?node.children[0]:node, true);
                        curMenu = node.children[0];
                    }
                } else {
                    zTree_Menu.expandNode(node);
                }
            }
            return !node.isParent;
        }


//                var zNodes=[
//                    {"id":1,"pId":6,"name":"基础信息","uri":"/dictionaries"},
//                    {"id":3,"pId":17,"name":"医生管理","uri":"/doctors"},
//                    {"id":4,"pId":17,"name":"患者管理","uri":"/patients"},
//                    {"id":5,"pId":17,"name":"管理员管理","uri":"/admin2s"},
//                    {"id":6,"pId":null,"name":"字典管理","uri":""},
//                    {"id":7,"pId":6,"name":"医院管理","uri":"/hospitals"},
//                    {"id":13,"pId":null,"name":"权限管理","uri":"/"},
//                    {"id":14,"pId":13,"name":"模块管理","uri":"/menus/show_all_menus"},
//                    {"id":15,"pId":13,"name":"角色管理","uri":"/menus/show"},
//                    {"id":16,"pId":6,"name":"地域信息管理","uri":"/provinces"},
//                    {"id":17,"pId":null,"name":"人员管理","uri":null},
//                    {"id":18,"pId":17,"name":"用户管理","uri":"/users"},
//                    {"id":19,"pId":null,"name":"用户关系","uri":null},
//                    {"id":20,"pId":19,"name":"医友关系","uri":"/doctor_friendships"},
//                    {"id":21,"pId":19,"name":"医患关系","uri":"/treatment_relationships"}
//                        ]

//        var zNodes=[
//            { "id":1, "pId":0, "name":"主菜单 1", open:true},
//            { "id":11, "pId":1, "name":"子菜单 1-1"},
//            { "id":110, "pId":11, "name":"子菜单 1-1"},
//            { "id":1100, "pId":110, "name":"子菜单 1-1"},
//            { "id":4, "pId":0, "name":"主菜单 3"},
//            { "id":41, "pId":4, "name":"子菜单 3-1"}
//        ]
        var zNodes=<%= raw  @left_menus.to_json %>
                $(document).ready(function(){
                    $.fn.zTree.init($("#leftMenus"), setting, zNodes);
                    zTree_Menu = $.fn.zTree.getZTreeObj("leftMenus");
//                  curMenu = zTree_Menu.getNodes()[0].children[0].children[0];
                    if (zTree_Menu.getNodes()[0].children != undefined) {
                        curMenu = zTree_Menu.getNodes()[0].children[0];
                    }
                    else {
                        curMenu = zTree_Menu.getNodes()[0]
                    }

                    zTree_Menu.selectNode(curMenu);
                    var a = $("#" + zTree_Menu.getNodes()[0].tId + "_a");
                    a.addClass("cur");
                });
        //-->

    </SCRIPT>
    <style type="text/css">
        #homeLeftMenus .ztree{
            width:20%;
            background: #3a3633;
            background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJod…BoZWlnaHQ9IjEiIGZpbGw9InVybCgjZ3JhZC11Y2dnLWdlbmVyYXRlZCkiIC8+Cjwvc3ZnPg==);
            background: -moz-linear-gradient(left,#3a3633 93%,#2a2725 100%);
            background: -webkit-gradient(linear,left top,right top,color-stop(93%,#3a3633),color-stop(100%,#2a2725));
            background: -webkit-linear-gradient(left,#3a3633 93%,#2a2725 100%);
            background: -o-linear-gradient(left,#3a3633 93%,#2a2725 100%);
            background: -ms-linear-gradient(left,#3a3633 93%,#2a2725 100%);
            background: linear-gradient(to right,#3a3633 93%,#2a2725 100%);
            padding:0px;
        }
        #homeLeftMenus .ztree * {
            padding: 0;
            margin: 0;
            font-size: 16px;
            font-family:"Microsof YaHei", Verdana, Arial !important;
        }
        a{ font-family: Verdana, Arial !important;}
        #homeLeftMenus .ztree li a{color:#a8a8a8;}
        #homeLeftMenus .ztree li a.level0 {
            text-decoration:none;
            width:100%;
            height: 39px;
            line-height:39px;
            text-align:left;
            display:block;
            background: #3a3633;
            background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJod…BoZWlnaHQ9IjEiIGZpbGw9InVybCgjZ3JhZC11Y2dnLWdlbmVyYXRlZCkiIC8+Cjwvc3ZnPg==);
            background: -moz-linear-gradient(left,#3a3633 93%,#2a2725 100%);
            background: -webkit-gradient(linear,left top,right top,color-stop(93%,#3a3633),color-stop(100%,#2a2725));
            background: -webkit-linear-gradient(left,#3a3633 93%,#2a2725 100%);
            background: -o-linear-gradient(left,#3a3633 93%,#2a2725 100%);
            background: -ms-linear-gradient(left,#3a3633 93%,#2a2725 100%);
            background: linear-gradient(to right,#3a3633 93%,#2a2725 100%);
            padding-left:10px;
            padding-right:10px;
        }
        #homeLeftMenus .ztree .level0{background:#403e3d;}

        #homeLeftMenus .ztree .level1:hover a{color:#fff;text-decoration:none;}
        #homeLeftMenus .ztree li a.level0.cur {
            background-color: #3a3633;
        }
        #homeLeftMenus .ztree li a.level0.cur span{
            color:#ffffff !important;
            font-weight:bold;

        }
        #homeLeftMenus .ztree li a.level0 span {
            display: block;
            color: #a8a8a8;
            line-height:39px;
            font-size:16px;
            word-spacing: 2px;
            font-family:"Microsoft YaHei", Verdana, Arial, Helvetica, AppleGothic, sans-serif;
        }
        #homeLeftMenus .ztree li a.level0 span.button {
            float:right;
            margin-left: 10px;
            visibility: visible;
            display:none;
        }
        #homeLeftMenus .ztree li span.button.switch.level0 {
            float:right;
        }
        #homeLeftMenus .ztree li a.curSelectedNode {
            padding-top: 0px;
            background-color:transparent !important;
            color: #fff !important;
            height: 16px;
            border:0px !important;
            opacity: 0.8;
            font-weight:bold;
        }
        #homeLeftMenus .ztree li span.button {
            line-height: 0;
            margin: 0;
            width: 16px;
            height: 16px;
            display: inline-block;
            vertical-align: middle;
            border: 0 none;
            cursor: pointer;
            outline: none;
            background-color: transparent;
            background-repeat: no-repeat;
            background-attachment: scroll;
            background-image: url("<%=asset_path 'img/zTreeStandard2.png'%>");
        }
        #homeLeftMenus .ztree li ul {
            margin: 0;
            padding: 0 0 0 18px;
        }
        #homeLeftMenus .ztree li {
            padding: 0;
            margin: 0;
            list-style: none;
            line-height: 33px;
            text-align: left;
            white-space: nowrap;
            outline: 0;
        }
        #homeLeftMenus .ztree li span.button.center_open {
            background-position: -92px -26px;
        }
        #homeLeftMenus .ztree li span.button.center_docu {
            background-position:-56px -26px;
        }

        #homeLeftMenus .ztree li span.button.switch {
            width: 18px;
            height: 36px;
        }
        #homeLeftMenus .ztree li span.button.center_close {
            background-position: -74px -26px;
        }
        #homeLeftMenus .ztree li span.button.bottom_close {
            background-position: -74px -58px;
        }
        #homeLeftMenus .ztree li span.button.bottom_docu {
            background-position: -56px -58px;
        }
        #homeLeftMenus .ztree li span.button.bottom_open {
            background-position: -92px -58px;
        }
        #homeLeftMenus .ztree li .level0.button.roots_open {
            background-position: -92px -80px;
        }
        #homeLeftMenus .ztree li .level0.button.roots_close {
            background-position: -74px -80px;
        }
        #homeLeftMenus .ztree li .level0.button.center_open {
            background-position: -92px -80px;
        }
        #homeLeftMenus .ztree li .level0.button.center_close {
            background-position: -74px -80px;
        }
        #homeLeftMenus .ztree li .level0.button.bottom_close {
            background-position: -74px -80px;
        }
        #homeLeftMenus .ztree li .level0.button.bottom_open {
            background-position: -92px -80px;
        }
        #homeLeftMenus .ztree li span.button.root_open {
            background-position: -92px -80px !important;
        }
        #homeLeftMenus .ztree li span.button.root_close {
            background-position: -74px -80px !important;
        }
        #homeLeftMenus .ztree li ul.line {
            background: url(<%=asset_path 'img/line_conn.gif'%>) 0 -9px repeat-y;
        }


    </style>
    <script>
        window.onload = function(){
            var h=window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;

            document.getElementById("homeLeftMenus").style.height = (h-57)+"px";
        }
    </script>
    <div class="zleftMenusBackground left" style="height:100%;float:left;width:15% !important;margin-top:-25px !important;overflow:hidden;" id="homeLeftMenus">
      <ul id="leftMenus" class="ztree" style="width:100%;height:100%;overflow:hidden;margin-top:0px !important;"></ul>
    </div>
    <div id="rightContent" style="float:right;width:85%;padding:10px;position:relative;">
      欢迎登录
    </div>
<%end%>