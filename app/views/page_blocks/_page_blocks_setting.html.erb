<style>
    .page_block_module {
        float: left;
    }

    #page_block_list {
        width: 1300px;
        margin:0 auto;
    }

    .p_title {
        display: none;
        background: #ffffff;
        color:#333333;
        width: 200px;
        height: 40px;
        line-height: 40px;
        font-weight:bold;
        text-align:center;
        margin-left:5px;
        border-radius:4px;
        border:2px dashed #cccccc;
    }
    .index_model_box_p_1 {
        width: 1188px !important;
        height: 300px;
        overflow: hidden;
        margin: 5px;
        float: left;
    }
    @media (min-width: 1200px) {
        .index_model_box_p_1 {
            width: 1188px !important;
            min-height: 300px;
            margin: 5px;
            float: left;
        }
    }

    @media (max-width: 960px) {
        .index_model_box_p_1 {
            width: 1188px !important;
            height: 300px;
            overflow: hidden;
            margin: 5px;
            float: left;
        }
    }

    @media (max-width: 683px) {
        .index_model_box_p_1 {
            width: 1188px !important;
            height: 300px;
            overflow: hidden;
            margin: 5px;
            float: left;
        }
    }
        /*登录模板 login*/
    .index_model_box_3_1 {
        width: 388px;
        height: 222px;
        overflow: hidden;
        border: 1px solid #e8e8e8;
        background: #fff;
        padding: 15px;
        margin: 5px;
        float: left;
    }

        /*屏幕尺寸大于1200px */
    @media (min-width: 1200px) {

        .index_model_box_3_1 {
            width: 388px !important;
            height: 222px;
            overflow: hidden;
            border: 1px solid #e8e8e8;
            background: #fff;
            padding: 15px;
            margin: 5px;
            float: left;
        }
    }

        /*屏幕尺寸小于960px*/
    @media (max-width: 960px) {

        .index_model_box_3_1 {
            width: 388px !important;
            height: 222px;
            overflow: hidden;
            border: 1px solid #e8e8e8;
            background: #fff;
            padding: 15px;
            margin: 5px;
            float: left;
        }
    }

        /*屏幕尺寸小于480px*/
    @media (max-width: 683px) {
        .index_model_box_3_1 {
            width: 388px !important;
            height: 222px;
            overflow: hidden;
            border: 1px solid #e8e8e8;
            background: #fff;
            padding: 15px;
            margin: 5px;
            float: left;
        }
    }
        /*图文列表模板*/
    .index_model_box_1_1 {
        width: 1188px !important;
        height: 300px;
        overflow: hidden;
        border: 1px solid #e8e8e8;
        background: #fff;
        padding: 15px;
        margin: 5px;
        float: left;
    }

    @media (min-width: 1200px) {
        .index_model_box_1_1 {
            width: 1188px !important;
            height: 300px;
            overflow: hidden;
            border: 1px solid #e8e8e8;
            background: #fff;
            padding: 15px;
            margin: 5px;
            float: left;
        }
    }

    @media (max-width: 960px) {
        .index_model_box_1_1 {
            width: 1188px !important;
            height: 300px;
            overflow: hidden;
            border: 1px solid #e8e8e8;
            background: #fff;
            padding: 15px;
            margin: 5px;
            float: left;
        }
    }

    @media (max-width: 683px) {
        .index_model_box_1_1 {
            width: 1188px !important;
            height: 300px;
            overflow: hidden;
            border: 1px solid #e8e8e8;
            background: #fff;
            padding: 15px;
            margin: 5px;
            float: left;
        }
    }
</style>
<div id="loader"></div>

<button id="layoutting" class="btn btn-primary">排版</button>
<button id="layout_save" class="btn btn-success">保存</button>
<button id="layout_cancle" class="btn btn-default">取消</button>
<hr />
<div id="page_block_list">
<% if !@page_block.nil? && !@page_block.empty? %>
  <% @page_block.each do |page|%>
      <div id="<%= page.id%>" class="page_block_module">
        <div class="p_title">拖拽排版</div>
        <%= raw page.content%>
      </div>
  <%end%>
<% end %>

</div>

<script>


    $(function(){
        var hospital_id=<%= @hospital_id%>
        var department_id=<%= @department_id%>
        var page_block_ids=[]; //存储页面排版的顺序
//点击按钮进行页面排版
        $("#layoutting").click(function(){
            $(".p_title").show();
        });
        $("#block_page").click(function(){
                    $(".p_title").hide();
                }
        );
//        取消排版
        $("#layout_cancle").click(function(){
            $.ajax({
                type:'get',
                url:'/page_blocks/page_blocks_setting',
                success:function(data){
                    $("#rightContent").html(data)
                }
            })
        });
//        保存排版
        $("#layout_save").click(function(){
            $.ajax({
                type:'post',
                url:'/page_blocks/update_position',
                data:{hospital_id:hospital_id,department_id:department_id,pageBlogIds:page_block_ids},
                success:function(data){
                    $("#rightContent").html(data)
                }
            })
        })

//        排版
        $(".p_title").bind('mouseover',function(){
            $(this).css("cursor","move")
        });'""'

        var $show = $("#loader");
        var $orderlist = $("#orderlist");
        var $list = $("#page_block_list");
        $list.sortable({
            opacity: 0.6, //设置拖动时候的透明度
            revert: true, //缓冲效果
            cursor: 'move', //拖动的时候鼠标样式
            handle: '.p_title',  //可以拖动的部位，模块的标题部分
            update: function(event, ui){
                page_block_ids=$(this).sortable('toArray').toString()
            }
        });
    });


</script>
